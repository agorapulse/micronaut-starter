@import io.micronaut.starter.application.Project

@args (
Project project
)

@if (project.getPackageName() != null) {
package @project.getPackageName()

}

import com.agorapulse.worker.annotation.Cron
import com.agorapulse.worker.annotation.FixedRate
import io.micronaut.core.async.publisher.Publishers
import jakarta.inject.Singleton
import org.reactivestreams.Publisher

@@Singleton
class EmailDigestDistributedJob {

    internal val emailsSent: MutableList<String> = arrayListOf()

    @@Cron("45 6 * * *")
    fun generateEmailsForDigest(): Publisher<String> {
        return Publishers.just("user@@example.com");
    }

    @@FixedRate("1s")
    fun sendEmail(email: String) {
        emailsSent.add(email);
        println("Sending email to $email");
    }

}